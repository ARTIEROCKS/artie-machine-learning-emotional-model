schema: '2.0'
stages:
  download:
    cmd: python3 src/download.py params.yaml
    outs:
    - path: data/CK+
      md5: e1c8b38aa6b547b44be89d1ae6bdd233.dir
      size: 1666260883
      nfiles: 10731
    - path: data/FER2013
      md5: 8951f54b0c9f75c74db0a1ce61c78bc5.dir
      size: 56516337
      nfiles: 35888
    - path: data/LirisChildren
      md5: 42e81046821beb33cf76a779c9f3a383.dir
      size: 458015053
      nfiles: 208
  download_videos:
    cmd: python src/download_videos_from_db.py params.yaml
    outs:
    - path: data/artie_videos
      md5: 285757fa3295e690d0a3fd2730e4a055.dir
      size: 166163587
      nfiles: 413
  data_augmentation:
    cmd: python3 src/bilstm_data_augmentation.py params.yaml
    deps:
    - path: data/CK+
      md5: e1c8b38aa6b547b44be89d1ae6bdd233.dir
      size: 1666260883
      nfiles: 10731
    - path: data/FER2013
      md5: 8951f54b0c9f75c74db0a1ce61c78bc5.dir
      size: 56516337
      nfiles: 35888
    - path: data/LirisChildren
      md5: 42e81046821beb33cf76a779c9f3a383.dir
      size: 458015053
      nfiles: 208
    outs:
    - path: data/CK_Augmented/CK+_augmented
      md5: 1d20a9027b0ab0b5e5b1c23297636f6d.dir
      size: 148581874
      nfiles: 2616
  normalization:
    cmd: python3 src/normalization.py params.yaml
    deps:
    - path: data/CK_Augmented/CK+_augmented
      md5: 1d20a9027b0ab0b5e5b1c23297636f6d.dir
      size: 148581874
      nfiles: 2616
    outs:
    - path: data/normalization
      md5: ad61a5174dde85bf22425674e50130ed.dir
      size: 106715976
      nfiles: 64155
  training:
    cmd: python3 src/training.py params.yaml
    deps:
    - path: data/normalization
      md5: ad61a5174dde85bf22425674e50130ed.dir
      size: 106715976
      nfiles: 64155
    params:
      params.yaml:
        training.batch_size: 64
        training.epochs: 100
        training.structure_layers:
        - CONV2D
        - CONV2D
        - MAXPOOLING2D
        - DROPOUT
        - CONV2D
        - MAXPOOLING2D
        - DROPOUT
        - CONV2D
        - MAXPOOLING2D
        - DROPOUT
        - CONV2D
        - MAXPOOLING2D
        - DROPOUT
        - FLATTEN
        - DENSE
        - DROPOUT
        - DENSE
        - DROPOUT
        - DENSE
        training.structure_values:
        - - 64
          - 3
          - 3
          - relu
          - valid
        - - 64
          - 3
          - 3
          - relu
          - valid
        - - 2
          - 2
          - 2
          - 2
        - - 0.5
        - - 64
          - 3
          - 3
          - relu
          - valid
        - - 2
          - 2
          - 2
          - 2
        - - 0.5
        - - 128
          - 3
          - 3
          - relu
          - valid
        - - 2
          - 2
          - 2
          - 2
        - - 0.5
        - - 256
          - 2
          - 2
          - relu
          - valid
        - - 2
          - 2
          - 2
          - 2
        - - 0.5
        - []
        - - 1024
          - relu
        - - 0.2
        - - 1024
          - relu
        - - 0.2
        - - 7
          - softmax
        training.train_percentage: 0.75
    outs:
    - path: metrics/plots.csv
      md5: 79777ae87963a56e45b7a543081fdb99
      size: 37158
    - path: metrics/scores.json
      md5: 34ff59f2aff437d1415bc8cd3f064df2
      size: 3405
    - path: model/fer.json
      md5: aa2c82587f7a72639f2e40c97773fc4d
      size: 9118
